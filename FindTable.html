<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>ผังโต้ะจีน - Ice &amp; Jumm</title>
    <meta
      name="description"
      content="ค้นหาโต้ะของคุณในงานแต่งงาน Ice & Jumm"
    />

    <!-- Tailwind via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Font for serif headings (Playfair Display) -->
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Inline theme tokens + helper utility classes -->
    <style>
      :root {
        --wedding-cream: oklch(0.97 0.01 85);
        --wedding-sage: oklch(0.65 0.04 145);
        --wedding-forest: oklch(0.35 0.05 150);
        --wedding-blush: oklch(0.85 0.05 25);
        --background: oklch(0.99 0.005 85);
        --foreground: oklch(0.35 0.05 150);
        --border: oklch(0.88 0.02 145);
      }
      .font-serif { font-family: "Playfair Display", serif; }
      .text-wedding-forest { color: var(--wedding-forest); }
      .text-wedding-sage { color: var(--wedding-sage); }
      .bg-wedding-cream { background-color: var(--wedding-cream); }
      .bg-wedding-cream-95 {
        background-color: color-mix(in oklab, var(--wedding-cream) 95%, transparent);
      }
      .bg-wedding-sage-20 {
        background-color: color-mix(in oklab, var(--wedding-sage) 20%, transparent);
      }
      .border-wedding-sage-20 {
        border-color: color-mix(in oklab, var(--wedding-sage) 20%, transparent);
      }
      body { background: var(--background); color: var(--foreground); }
      @supports not (background: color-mix(in oklab, red 50%, white)) {
        .bg-wedding-cream-95 { background-color: rgba(247, 246, 242, 0.95); }
        .bg-wedding-sage-20 { background-color: rgba(100, 133, 117, 0.2); }
        .border-wedding-sage-20 { border-color: rgba(100, 133, 117, 0.2); }
      }
      select {
        background-image: linear-gradient(45deg, transparent 50%, #6b7280 50%),
          linear-gradient(135deg, #6b7280 50%, transparent 50%),
          linear-gradient(to right, #d1d5db, #d1d5db);
        background-position: calc(100% - 18px) calc(1em + 2px),
          calc(100% - 13px) calc(1em + 2px), calc(100% - 2.5rem) 0.5rem;
        background-size: 5px 5px, 5px 5px, 1px 1.5rem;
        background-repeat: no-repeat;
        -webkit-appearance: none; -moz-appearance: none; appearance: none;
      }
      .glass { backdrop-filter: blur(6px); -webkit-backdrop-filter: blur(6px); }
    </style>
  </head>

  <body class="antialiased">
    <!-- Background image + gradient overlay -->
    <div class="min-h-screen relative overflow-hidden">
      <div id="bg" class="absolute inset-0 bg-cover bg-center bg-no-repeat"></div>
      <div
        class="absolute inset-0"
        id="overlay"
        style="
          background:
            linear-gradient(
              to right,
              color-mix(in oklab, var(--background) 95%, transparent) 0%,
              color-mix(in oklab, var(--background) 80%, transparent) 35%,
              color-mix(in oklab, var(--background) 60%, transparent) 60%,
              transparent 100%
            );
        "
      ></div>

      <!-- Content -->
      <main class="relative z-10 min-h-screen flex items-center">
        <div class="container px-4 md:px-8 lg:px-12">
          <div class="max-w-md lg:max-w-lg">
            <!-- Heading -->
            <header class="mb-8 md:mb-12">
              <h1 class="font-serif text-4xl md:text-5xl lg:text-6xl text-balance mb-3 text-wedding-forest">
                ผังโต้ะจีน
              </h1>
              <p class="text-lg md:text-xl text-wedding-sage leading-relaxed">
                Ice &amp; Jumm
              </p>
            </header>

            <!-- Card -->
            <section id="card" class="bg-wedding-cream-95 glass rounded-2xl p-6 md:p-8 shadow-2xl border border-wedding-sage-20">
              <!-- Search Form -->
              <div id="form-view" class="space-y-6">
                <!-- ฝั่ง -->
                <div class="space-y-2">
                  <label for="side" class="block text-base md:text-lg font-medium text-wedding-forest">แขกฝั่ง</label>
                  <select
                    id="side"
                    class="w-full bg-white border border-gray-300 focus:outline-none focus:ring-2 focus:ring-[color:oklch(0.65_0.04_145)] rounded-lg px-4 py-3 text-[16px] text-wedding-forest"
                  >
                    <option value="" selected>เลือกฝั่ง</option>
                    <option value="เจ้าสาว">เจ้าสาว</option>
                    <option value="เจ้าบ่าว">เจ้าบ่าว</option>
                  </select>
                </div>

                <!-- ความสัมพันธ์ -->
                <div class="space-y-2">
                  <label for="relationship" class="block text-base md:text-lg font-medium text-wedding-forest">ความสัมพันธ์</label>
                  <select
                    id="relationship"
                    class="w-full bg-white border border-gray-300 rounded-lg px-4 py-3 text-[16px] text-wedding-forest disabled:opacity-50"
                    disabled
                  >
                    <option value="">กรุณาเลือกฝั่งก่อน</option>
                  </select>
                </div>

                <!-- (detail1/detail2 เผื่ออนาคต: ซ่อนไว้) -->
                <div id="detail1-wrap" class="space-y-2 hidden">
                  <label for="detail1" class="block text-base md:text-lg font-medium text-wedding-forest">ขยายความ 1</label>
                  <select id="detail1" class="w-full bg-white border border-gray-300 rounded-lg px-4 py-3 text-[16px] text-wedding-forest disabled:opacity-50" disabled>
                    <option value="">กรุณาเลือกความสัมพันธ์ก่อน</option>
                  </select>
                </div>
                <div id="detail2-wrap" class="space-y-2 hidden">
                  <label for="detail2" class="block text-base md:text-lg font-medium text-wedding-forest">ขยายความ 2</label>
                  <select id="detail2" class="w-full bg-white border border-gray-300 rounded-lg px-4 py-3 text-[16px] text-wedding-forest disabled:opacity-50" disabled>
                    <option value="">กรุณาเลือกขยายความ 1 ก่อน</option>
                  </select>
                </div>

                <!-- รายชื่อ -->
                <div class="space-y-2">
                  <label for="guest" class="block text-base md:text-lg font-medium text-wedding-forest">รายชื่อและผู้ติดตาม</label>
                  <select
                    id="guest"
                    class="w-full bg-white border border-gray-300 rounded-lg px-4 py-3 text-[16px] text-wedding-forest disabled:opacity-50"
                    disabled
                  >
                    <option value="">กรุณาเลือกความสัมพันธ์ก่อน</option>
                  </select>
                </div>

                <!-- Action -->
                <button
                  id="searchBtn"
                  class="w-full bg-[color:oklch(0.35_0.05_150)] hover:opacity-90 text-[color:oklch(0.97_0.01_85)] text-base md:text-lg py-4 rounded-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed"
                  disabled
                >
                  ค้นหาโต้ะ
                </button>
              </div>

              <!-- Result View -->
              <div id="result-view" class="space-y-6 text-center hidden">
                <div class="space-y-4">
                  <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-wedding-sage-20 mb-2">
                    <span class="text-3xl">✓</span>
                  </div>
                  <h2 class="font-serif text-2xl md:text-3xl text-wedding-forest">พบข้อมูลของคุณแล้ว!</h2>
                </div>

                <div class="space-y-4 py-6">
                  <div class="bg-white/60 rounded-xl p-6 border border-wedding-sage-20">
                    <p class="text-sm text-wedding-sage mb-2">จำนวนแขก</p>
                    <p id="result-guestCount" class="text-4xl md:text-5xl font-serif text-wedding-forest">–</p>
                  </div>
                  <div class="bg-white/60 rounded-xl p-6 border border-wedding-sage-20">
                    <p class="text-sm text-wedding-sage mb-2">เบอร์โต้ะ</p>
                    <p id="result-tableNumber" class="text-4xl md:text-5xl font-serif text-wedding-forest">–</p>
                  </div>
                </div>

                <button id="resetBtn" class="w-full border border-wedding-sage-20 text-wedding-forest hover:bg-black/5 text-base py-4 rounded-xl bg-transparent">
                  ค้นหาอีกครั้ง
                </button>
              </div>
            </section>
          </div>
        </div>
      </main>
    </div>

    <script>
      // === CONFIG ===
      const BACKGROUND_URL =
        "https://hebbkx1anhila5yf.public.blob.vercel-storage.com/TableLayout-n8KYXBtDLSI4j0lnCSUPnPWUbgKstp.png";

      // === DATA (normalized & confirmed) ===
      /**
       * @typedef {Object} Guest
       * @property {string} side
       * @property {string} relationship   // ถ้าไม่กำหนด จะถือว่า "ไม่ระบุ"
       * @property {string} name
       * @property {number} guestCount
       * @property {number} tableNumber
       */
      /** @type {Guest[]} */
      const guestData = [
        { side: 'เจ้าสาว', relationship: '', name: 'ชัญญา สาทิตานนท์(เฟ) Bridesmaids', guestCount: 1, tableNumber: 1 },
        { side: 'เจ้าสาว', relationship: '', name: 'กฤชอร ปองเสงี่ยม (มู่หลาน) Bridesmaids', guestCount: 1, tableNumber: 1 },
        { side: 'เจ้าสาว', relationship: '', name: 'กมลวรรณ เจริญเรืองทรัพย์ (ต้นหลิว) Bridesmaids', guestCount: 1, tableNumber: 1 },
        { side: 'เจ้าสาว', relationship: '', name: 'นางสาวสุชัญญา ศรีวารี (ใบพลู) Bridesmaids', guestCount: 1, tableNumber: 1 },
        { side: 'เจ้าสาว', relationship: 'ญาติแม่เจ้าสาว', name: 'เฟิน เมทินี เตชะอภัยคุณ (เฟิน)', guestCount: 3, tableNumber: 1 },
        { side: 'เจ้าสาว', relationship: 'ญาติแม่เจ้าสาว', name: 'ยี่กู๋ (กรียาพัตร์ เตชะอภัยคุณ (น้อย))', guestCount: 3, tableNumber: 1 },
        { side: 'เจ้าสาว', relationship: 'ญาติแม่เจ้าสาว', name: 'ตั่วกู๋และภรรยา', guestCount: 2, tableNumber: 2 },
        { side: 'เจ้าสาว', relationship: 'ญาติแม่เจ้าสาว', name: 'พี่ติ้กและสามี', guestCount: 4, tableNumber: 2 },
        { side: 'เจ้าสาว', relationship: 'ญาติแม่เจ้าสาว', name: 'พี่ตั้กและสามี', guestCount: 4, tableNumber: 2 },
        { side: 'เจ้าสาว', relationship: '', name: 'พี่บิ๊ก ผอ.สนผ. SEPO', guestCount: 1, tableNumber: 3 },
        { side: 'เจ้าสาว', relationship: '', name: 'พี่กุ้ง ชช. สนผ. SEPO', guestCount: 1, tableNumber: 3 },
        { side: 'เจ้าสาว', relationship: '', name: 'พี่ปุ๊ก ที่ปรึกษาด้านพัฒนารัฐวิสาหกิจ SEPO', guestCount: 1, tableNumber: 3 },
        { side: 'เจ้าสาว', relationship: '', name: 'พี่นก C8 SEPO', guestCount: 1, tableNumber: 3 },
        { side: 'เจ้าสาว', relationship: '', name: 'พี่โย C8 SEPO', guestCount: 1, tableNumber: 3 },
        { side: 'เจ้าสาว', relationship: '', name: 'พี่ผึ้ง C8 หัวหน้าเจ้าสาว SEPO', guestCount: 1, tableNumber: 3 },
        { side: 'เจ้าบ่าว', relationship: '', name: 'คุณ ฉัตรชัย ศิริไล ธ.ก.ส.', guestCount: 1, tableNumber: 3 },
        { side: 'เจ้าบ่าว', relationship: 'เพื่อนแม่เจ้าบ่าว', name: 'พิษณุพร ขาวประเสริฐ', guestCount: 1, tableNumber: 3 },
        { side: 'เจ้าบ่าว', relationship: 'เพื่อนแม่เจ้าบ่าว', name: 'อภิรัตน์ ตันติเวชกุบ (เอ๋)', guestCount: 2, tableNumber: 3 },
        { side: 'เจ้าสาว', relationship: '', name: 'อีฟ KU', guestCount: 2, tableNumber: 4 },
        { side: 'เจ้าสาว', relationship: '', name: 'พัชราภรณ์ พิมพ์สุวรรณ์ (ปุ๋มปิ๋ม) KU', guestCount: 2, tableNumber: 4 },
        { side: 'เจ้าสาว', relationship: '', name: 'ปาณิศา ณรงค์ราช (มายด์) KU', guestCount: 2, tableNumber: 4 },
        { side: 'เจ้าสาว', relationship: '', name: 'หมูเล้ก KU', guestCount: 1, tableNumber: 4 },
        { side: 'เจ้าสาว', relationship: '', name: 'ฝ้าย KU', guestCount: 1, tableNumber: 4 },
        { side: 'เจ้าสาว', relationship: '', name: 'แตงกวา KU', guestCount: 1, tableNumber: 4 },
        { side: 'เจ้าสาว', relationship: 'ญาติแม่เจ้าสาว', name: 'พี่ตั้มและแฟน', guestCount: 2, tableNumber: 5 },
        { side: 'เจ้าสาว', relationship: 'ญาติแม่เจ้าสาว', name: 'โซยอี้', guestCount: 2, tableNumber: 5 },
        { side: 'เจ้าสาว', relationship: 'ญาติแม่เจ้าสาว', name: 'ยี่อี้', guestCount: 2, tableNumber: 5 },
        { side: 'เจ้าสาว', relationship: 'เพื่อนแม่เจ้าสาว', name: 'น้าวิ', guestCount: 1, tableNumber: 5 },
        { side: 'เจ้าสาว', relationship: 'เพื่อนแม่เจ้าสาว', name: 'มาริสา กรุณานนท์', guestCount: 1, tableNumber: 5 },
        { side: 'เจ้าสาว', relationship: 'เพื่อนแม่เจ้าสาว', name: 'น้ากบ', guestCount: 1, tableNumber: 5 },
        { side: 'เจ้าสาว', relationship: 'เพื่อนแม่เจ้าสาว', name: 'น้าฝน', guestCount: 1, tableNumber: 5 },
        { side: 'เจ้าสาว', relationship: 'ญาติพ่อเจ้าสาว', name: 'ซาโกว', guestCount: 1, tableNumber: 6 },
        { side: 'เจ้าสาว', relationship: 'ญาติพ่อเจ้าสาว', name: 'โกนี', guestCount: 1, tableNumber: 6 },
        { side: 'เจ้าสาว', relationship: 'ญาติพ่อเจ้าสาว', name: 'โกแมว', guestCount: 1, tableNumber: 6 },
        { side: 'เจ้าสาว', relationship: 'ญาติพ่อเจ้าสาว', name: 'น้องหลิว', guestCount: 1, tableNumber: 6 },
        { side: 'เจ้าสาว', relationship: '', name: 'ครอบครัวเจ้าสาว', guestCount: 4, tableNumber: 6 },
        { side: 'เจ้าบ่าว', relationship: 'พ่อแม่เจ้าบ่าว', name: 'ไลวรรณ ปองเสงี่ยม (พ่อ + แม่)', guestCount: 2, tableNumber: 6 },
        { side: 'เจ้าบ่าว', relationship: 'ญาติพ่อเจ้าบ่าว', name: 'โกวเล็ก (รถเข็น 1 ท่าน)', guestCount: 4, tableNumber: 7 },
        { side: 'เจ้าบ่าว', relationship: 'ญาติพ่อเจ้าบ่าว', name: 'แปะฮ้วด', guestCount: 2, tableNumber: 7 },
        { side: 'เจ้าบ่าว', relationship: 'ญาติพ่อเจ้าบ่าว', name: 'พี่โจ้ ปองเสงี่ยม', guestCount: 4, tableNumber: 7 },
        { side: 'เจ้าสาว', relationship: 'ญาติแม่เจ้าสาว', name: 'โซ้ยกู๋', guestCount: 2, tableNumber: 8 },
        { side: 'เจ้าสาว', relationship: 'ญาติแม่เจ้าสาว', name: 'ฐิติภูมิ เตชะอภัยคุณ (นิว)', guestCount: 1, tableNumber: 8 },
        { side: 'เจ้าสาว', relationship: 'ญาติแม่เจ้าสาว', name: 'คงกฤษ เตชะอภัยคุณ (แม็ก)', guestCount: 1, tableNumber: 8 },
        { side: 'เจ้าบ่าว', relationship: 'ญาติแม่เจ้าบ่าว', name: 'M', guestCount: 2, tableNumber: 8 },
        { side: 'เจ้าบ่าว', relationship: 'ญาติแม่เจ้าบ่าว', name: 'ภาวิณี นภาพงษ์จันทรา (หลิ่นตี๊)', guestCount: 2, tableNumber: 8 },
        { side: 'เจ้าบ่าว', relationship: 'ญาติแม่เจ้าบ่าว', name: 'ชัยวัต + ครอบครัว หาดใหญ่', guestCount: 2, tableNumber: 8 },
        { side: 'เจ้าบ่าว', relationship: '', name: 'พดน ชินพิพัฒน์ (บูม) CityU', guestCount: 1, tableNumber: 9 },
        { side: 'เจ้าบ่าว', relationship: '', name: 'วรวัชร สุขเกื้อ (Bolt) CityU', guestCount: 2, tableNumber: 9 },
        { side: 'เจ้าสาว', relationship: '', name: 'ป่าน+แตงกวา Reading', guestCount: 2, tableNumber: 9 },
        { side: 'เจ้าสาว', relationship: '', name: 'พี่ดราฟ SEPO', guestCount: 1, tableNumber: 9 },
        { side: 'เจ้าสาว', relationship: '', name: 'พี่หนึ่ง SEPO', guestCount: 1, tableNumber: 9 },
        { side: 'เจ้าสาว', relationship: '', name: 'เจ้แอม+สามี Reading', guestCount: 2, tableNumber: 9 },
        { side: 'เจ้าบ่าว', relationship: 'ญาติพ่อเจ้าบ่าว', name: 'วิวัฒน์ ปองเสงี่ยม', guestCount: 3, tableNumber: 10 },
        { side: 'เจ้าบ่าว', relationship: 'พี่น้องเจ้าบ่าว', name: 'แจน พี่สาวจ้ำ', guestCount: 2, tableNumber: 10 },
        { side: 'เจ้าบ่าว', relationship: 'ญาติพ่อเจ้าบ่าว', name: 'ยุพดี ปองเสงี่ยม', guestCount: 4, tableNumber: 10 },
        { side: 'เจ้าบ่าว', relationship: '', name: 'Gorn SIIT', guestCount: 2, tableNumber: 11 },
        { side: 'เจ้าบ่าว', relationship: '', name: 'โจ๋สุดหล่อ SIIT', guestCount: 2, tableNumber: 11 },
        { side: 'เจ้าบ่าว', relationship: '', name: 'เตชนิธิ SIIT', guestCount: 2, tableNumber: 11 },
        { side: 'เจ้าบ่าว', relationship: '', name: 'ภูวิช แอน SIIT', guestCount: 2, tableNumber: 11 },
        { side: 'เจ้าบ่าว', relationship: '', name: 'อิทธิพัทธ์ คำพา (เต้ย) SIIT', guestCount: 2, tableNumber: 11 },
        { side: 'เจ้าบ่าว', relationship: '', name: 'พลอานันต์ จองลิขิต (นีโน่) SIIT', guestCount: 1, tableNumber: 12 },
        { side: 'เจ้าบ่าว', relationship: '', name: 'อาร์ท SIIT', guestCount: 1, tableNumber: 12 },
        { side: 'เจ้าสาว', relationship: '', name: 'แอลลี่ SJB', guestCount: 1, tableNumber: 12 },
        { side: 'เจ้าสาว', relationship: '', name: 'ณัฐพร ลิ้มตระกูลชัย (แนน) FWD', guestCount: 1, tableNumber: 12 },
        { side: 'เจ้าบ่าว', relationship: '', name: 'Oil ออย SIIT', guestCount: 2, tableNumber: 12 },
        { side: 'เจ้าบ่าว', relationship: '', name: 'ชมพูนุท ปลื้มจิต -ชมพู่ SIIT', guestCount: 2, tableNumber: 12 },
        { side: 'เจ้าบ่าว', relationship: '', name: 'วุ้น SIIT', guestCount: 2, tableNumber: 12 },
        { side: 'เจ้าบ่าว', relationship: 'ญาติแม่เจ้าบ่าว', name: 'สมพจน์ (เหว่งซก) และครอบครัว', guestCount: 2, tableNumber: 13 },
        { side: 'เจ้าบ่าว', relationship: 'ญาติแม่เจ้าบ่าว', name: 'ธนพร พงศ์พิศิษฎ์สกุล (หงี่กู)', guestCount: 1, tableNumber: 13 },
        { side: 'เจ้าบ่าว', relationship: 'ญาติแม่เจ้าบ่าว', name: 'วาศิณี พงศ์พิศิษฎ์สกุล (อี๊ส้ม)', guestCount: 1, tableNumber: 13 },
        { side: 'เจ้าบ่าว', relationship: 'ญาติแม่เจ้าบ่าว', name: 'นวรัตน์ พงศ์พิศิษฎ์สกุล (รัตน์, หม่าม้า)', guestCount: 2, tableNumber: 13 },
        { side: 'เจ้าบ่าว', relationship: 'ญาติแม่เจ้าบ่าว', name: 'นภาพร แก่นเพิ่ม (พี่กุ้ง และครอบครัว)', guestCount: 4, tableNumber: 13 },
        { side: 'เจ้าบ่าว', relationship: 'เพื่อนพ่อเจ้าบ่าว', name: 'นาย สุวิทย์ ขจรเดชากุล', guestCount: 1, tableNumber: 14 },
        { side: 'เจ้าบ่าว', relationship: 'เพื่อนพ่อเจ้าบ่าว', name: 'พรชัย ปิ่นทอง', guestCount: 1, tableNumber: 14 },
        { side: 'เจ้าบ่าว', relationship: 'เพื่อนพ่อเจ้าบ่าว', name: 'พล.อ.โกญจนาท ศุกระเศรณี', guestCount: 1, tableNumber: 14 },
        { side: 'เจ้าบ่าว', relationship: 'เพื่อนพ่อเจ้าบ่าว', name: 'นายริทัศน์ ศรีทะวงศ์', guestCount: 2, tableNumber: 14 },
        { side: 'เจ้าบ่าว', relationship: '', name: 'พี่ๆ Dextra Holding Services', guestCount: 5, tableNumber: 14 },
        { side: 'เจ้าสาว', relationship: '', name: 'แตมป์ CPALL', guestCount: 1, tableNumber: 15 },
        { side: 'เจ้าสาว', relationship: '', name: 'โบ CPALL', guestCount: 1, tableNumber: 15 },
        { side: 'เจ้าสาว', relationship: '', name: 'เอิร์ท CPALL', guestCount: 1, tableNumber: 15 },
        { side: 'เจ้าสาว', relationship: '', name: 'วี่ CPALL', guestCount: 1, tableNumber: 15 },
        { side: 'เจ้าบ่าว', relationship: 'เจ Jaspal', name: 'ชนก อำไพ', guestCount: 1, tableNumber: 15 },
        { side: 'เจ้าบ่าว', relationship: 'ตั้ม Jaspal', name: 'อธิป เก้าเด่น', guestCount: 1, tableNumber: 15 },
        { side: 'เจ้าบ่าว', relationship: 'Bank Jaspal', name: 'Chokchai Thawatcharaporn', guestCount: 2, tableNumber: 15 },
        { side: 'เจ้าบ่าว', relationship: 'พี่ต้ะ Jaspal', name: 'พิทักษ์สิน สมวงศ์(ต๊ะ)', guestCount: 2, tableNumber: 15 },
      ];

      // === ELEMENTS ===
      const bgEl = document.getElementById("bg");
      const formView = document.getElementById("form-view");
      const resultView = document.getElementById("result-view");

      const sideEl = document.getElementById("side");
      const relEl = document.getElementById("relationship");
      const detail1Wrap = document.getElementById("detail1-wrap");
      const detail2Wrap = document.getElementById("detail2-wrap");
      const detail1El = document.getElementById("detail1");
      const detail2El = document.getElementById("detail2");
      const guestEl = document.getElementById("guest");
      const searchBtn = document.getElementById("searchBtn");
      const resetBtn = document.getElementById("resetBtn");

      const resGuestCount = document.getElementById("result-guestCount");
      const resTableNumber = document.getElementById("result-tableNumber");

      // === INIT BG ===
      bgEl.style.backgroundImage = `url('${BACKGROUND_URL}')`;

      // === HELPERS ===
      function setOptions(select, options, placeholder) {
        select.innerHTML = "";
        const ph = document.createElement("option");
        ph.value = "";
        ph.textContent = placeholder;
        ph.selected = true;
        select.appendChild(ph);
        options.forEach((opt) => {
          const o = document.createElement("option");
          o.value = opt;
          o.textContent = opt;
          select.appendChild(o);
        });
      }

      function uniqueSorted(arr) {
        return Array.from(new Set(arr)).sort((a, b) =>
          (a || "").localeCompare(b || "", "th")
        );
      }

      // === DYNAMIC OPTION BUILDERS ===
      function buildRelationships(side) {
        if (!side) return [];
        const forSide = guestData.filter((g) => g.side === side);
        const nonEmpty = uniqueSorted(
          forSide.map((g) => (g.relationship || "").trim()).filter((s) => s !== "")
        );
        const hasEmpty = forSide.some((g) => !g.relationship || g.relationship.trim() === "");
        // ถ้ามีรายชื่อที่ relationship ว่าง ให้เพิ่มตัวเลือก "ไม่ระบุ"
        if (hasEmpty) nonEmpty.push("ไม่ระบุ");
        return nonEmpty;
      }

      function buildGuests(side, relationship, detail1, detail2) {
        if (!side) return [];
        let filtered = guestData.filter((g) => g.side === side);

        if (relationship && relationship !== "ไม่ระบุ") {
          filtered = filtered.filter((g) => (g.relationship || "").trim() === relationship.trim());
        } else if (relationship === "ไม่ระบุ") {
          filtered = filtered.filter((g) => !g.relationship || g.relationship.trim() === "");
        }
        // detail1/detail2 reserved for future (no-op now)

        return uniqueSorted(filtered.map((g) => g.name));
      }

      // === STATE & EVENTS ===
      function resetAll() {
        relEl.disabled = true;
        detail1El.disabled = true;
        detail2El.disabled = true;
        guestEl.disabled = true;

        setOptions(relEl, [], "กรุณาเลือกฝั่งก่อน");
        setOptions(detail1El, [], "กรุณาเลือกความสัมพันธ์ก่อน");
        setOptions(detail2El, [], "กรุณาเลือกขยายความ 1 ก่อน");
        setOptions(guestEl, [], "กรุณาเลือกความสัมพันธ์ก่อน");

        detail1Wrap.classList.add("hidden");
        detail2Wrap.classList.add("hidden");

        searchBtn.disabled = true;
        resultView.classList.add("hidden");
        formView.classList.remove("hidden");
      }

      sideEl.addEventListener("change", () => {
        const side = sideEl.value;

        // Reset downstream
        relEl.value = detail1El.value = detail2El.value = guestEl.value = "";
        searchBtn.disabled = true;

        const relationships = buildRelationships(side);

        if (side && relationships.length > 0) {
          setOptions(relEl, relationships, "เลือกความสัมพันธ์");
          relEl.disabled = false;

          // reset lower levels
          detail1Wrap.classList.add("hidden");
          detail2Wrap.classList.add("hidden");
          detail1El.disabled = true;
          detail2El.disabled = true;

          setOptions(guestEl, [], "กรุณาเลือกความสัมพันธ์ก่อน");
          guestEl.disabled = true;
        } else if (side && relationships.length === 0) {
          // ไม่มี relationship เลย: ให้เลือกชื่อได้ทันทีจากฝั่ง
          relEl.disabled = true;
          setOptions(relEl, [], "ไม่มีความสัมพันธ์ให้เลือก");

          const guests = buildGuests(side, "", "", "");
          setOptions(guestEl, guests, "เลือกชื่อ");
          guestEl.disabled = guests.length === 0;
        } else {
          resetAll();
        }
      });

      relEl.addEventListener("change", () => {
        const side = sideEl.value;
        const relationship = relEl.value;

        detail1El.value = detail2El.value = guestEl.value = "";
        searchBtn.disabled = true;

        // (ไม่มี detail1/detail2 ในชุดข้อมูลนี้)
        detail1Wrap.classList.add("hidden");
        detail2Wrap.classList.add("hidden");
        detail1El.disabled = true;
        detail2El.disabled = true;

        const guests = buildGuests(side, relationship, "", "");
        setOptions(guestEl, guests, relationship ? "เลือกชื่อ" : "กรุณาเลือกความสัมพันธ์ก่อน");
        guestEl.disabled = guests.length === 0;
      });

      guestEl.addEventListener("change", () => {
        const hasAll = sideEl.value && guestEl.value;
        searchBtn.disabled = !hasAll;
      });

      document.getElementById("searchBtn").addEventListener("click", () => {
        const side = sideEl.value;
        const relationship = relEl.value;
        const name = guestEl.value;
        if (!side || !name) return;

        // หาแมตช์: ถ้าเลือก "ไม่ระบุ" ให้หาเฉพาะ relationship ว่าง
        const isUnspecified = relationship === "ไม่ระบุ" || relationship === "";
        const match = guestData.find((g) =>
          g.side === side &&
          g.name === name &&
          (isUnspecified ? (!g.relationship || g.relationship.trim() === "") : ((g.relationship || "").trim() === relationship.trim()))
        );

        if (match) {
          document.getElementById("result-guestCount").textContent = String(match.guestCount);
          document.getElementById("result-tableNumber").textContent = String(match.tableNumber);
          formView.classList.add("hidden");
          resultView.classList.remove("hidden");
        } else {
          alert("ไม่พบข้อมูลของคุณ กรุณาลองใหม่อีกครั้ง");
        }
      });

      document.getElementById("resetBtn").addEventListener("click", resetAll);

      // First load
      resetAll();
    </script>
  </body>
</html>
